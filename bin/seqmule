#!/usr/bin/env perl

#Copyright (C) <2012>  <Yunfei Guo>
#
###This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.
#
###This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.
#
###You should have received a copy of the GNU General Public License along with this program.  If not, see <http://www.gnu.org/licenses/>.
#
#

use strict;
use warnings;
use FindBin qw/$RealBin/;
use File::Spec;


my $versionfile=File::Spec->catfile($RealBin,"..","version");
die "Version file missing.\n" unless -f $versionfile;
my $version=`head -n1 $versionfile`;
chomp $version;

my $subprogram=shift @ARGV;
my @all_subprograms = qw/download pipeline stats run update/;

die
"Program: seqmule (automated pipeline for whole exome/genome analysis)
Version: $version

Usage:   seqmule <subprogram> [options]

Command:
download        download default databases
pipeline        generate analysis scripts
run             execute seqmule-generated scripts
stats           produce statistics and plots
update          automatic update SeqMule
\n" if (!defined $subprogram or !(grep{$subprogram eq $_} @all_subprograms));

warn "Current version: $version\n";
system(File::Spec->catfile($RealBin,"secondary","checkupgrade"));

exec(File::Spec->catfile($RealBin,"secondary",$subprogram),@ARGV);
